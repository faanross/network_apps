# adapted from Black Hat Python for python3